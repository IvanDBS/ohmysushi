lib/
├── bot.rb (основной файл бота)
├── handlers/
│   ├── callback_handler.rb (обработка callback-запросов)
│   └── message_handler.rb (обработка текстовых сообщений)
├── models/
│   └── init.rb (инициализация БД)
└── services/
    ├── menu_service.rb (работа с меню)
    ├── order_service.rb (работа с заказами)
    └── payment_service.rb (работа с платежами)
    Создай Telegram-бота для ресторана "Oh My Sushi" со следующей структурой:

1. Архитектура:
- Разделить код на небольшие модули (не более 200 строк в файле)
- Использовать паттерн State для управления состояниями
- Вынести бизнес-логику в отдельные сервисы
- Использовать репозитории для работы с БД

2. Основные модули:
a) Core:
   - Bot (инициализация и запуск)
   - Config (конфигурация)
   - Logger (логирование)

b) Handlers:
   - MessageHandler (обработка текстовых сообщений)
   - CallbackHandler (обработка callback-запросов)
   - CommandHandler (обработка команд)

c) States:
   - BaseState (базовый класс для состояний)
   - MenuState (просмотр меню)
   - CartState (работа с корзиной)
   - CheckoutState (оформление заказа)
   - PaymentState (оплата)

d) Services:
   - MenuService (работа с меню)
   - CartService (работа с корзиной)
   - OrderService (работа с заказами)
   - PaymentService (работа с платежами)

e) Repositories:
   - BaseRepository (базовый класс для репозиториев)
   - MenuRepository (работа с меню в БД)
   - CartRepository (работа с корзиной в БД)
   - OrderRepository (работа с заказами в БД)

3. База данных:
- Использовать миграции
- Добавить индексы
- Использовать транзакции
- Добавить валидацию данных

4. Требования к коду:
- Каждый класс должен иметь одну ответственность
- Код должен быть покрыт тестами
- Добавить документацию
- Использовать константы вместо магических чисел
- Добавить обработку ошибок
- Использовать логирование

5. Функциональность:
a) Меню:
   - Категории
   - Товары
   - Поиск
   - Фильтрация

b) Корзина:
   - Добавление/удаление товаров
   - Изменение количества
   - Очистка корзины

c) Заказ:
   - Сбор данных о доставке
   - Валидация данных
   - Подтверждение заказа

d) Оплата:
   - Наличные
   - Онлайн оплата
   - Обработка статусов

6. Безопасность:
- Валидация входных данных
- Защита от SQL-инъекций
- Безопасное хранение токенов
- Логирование действий

7. Производительность:
- Кэширование данных
- Оптимизация запросов
- Асинхронная обработка
- Очереди для тяжелых операций

8. Мониторинг:
- Логирование ошибок
- Метрики производительности
- Уведомления об ошибках
- Статистика использования